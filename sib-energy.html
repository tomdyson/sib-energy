<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Energy Analysis Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cheap: '#10b981',
                        peak: '#f59e0b',
                        sauna: '#ef4444',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }
        .cheap-gradient { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .peak-gradient { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .sauna-gradient { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .insight-card {
            border-left: 4px solid;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Header -->
    <header class="py-8 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold text-white mb-2">Home Energy Report</h1>
                    <p class="text-slate-300">Analysis Period: 31 Dec 2025 â€“ 29 Jan 2026</p>
                </div>
                <div class="text-right">
                    <div class="text-slate-400 text-sm">Generated</div>
                    <div class="text-white font-medium">30 January 2026</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Summary Stats -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="stat-card rounded-2xl p-6 shadow-lg">
                    <div class="text-slate-500 text-sm font-medium mb-1">Total Consumption</div>
                    <div class="text-3xl font-bold text-slate-800">2,871</div>
                    <div class="text-slate-600">kWh</div>
                </div>
                <div class="stat-card rounded-2xl p-6 shadow-lg">
                    <div class="text-slate-500 text-sm font-medium mb-1">Total Cost</div>
                    <div class="text-3xl font-bold text-slate-800">Â£591.77</div>
                    <div class="text-slate-600">this period</div>
                </div>
                <div class="stat-card rounded-2xl p-6 shadow-lg">
                    <div class="text-slate-500 text-sm font-medium mb-1">Daily Average</div>
                    <div class="text-3xl font-bold text-slate-800">96</div>
                    <div class="text-slate-600">kWh/day</div>
                </div>
                <div class="stat-card rounded-2xl p-6 shadow-lg">
                    <div class="text-slate-500 text-sm font-medium mb-1">Sauna Sessions</div>
                    <div class="text-3xl font-bold text-slate-800">10</div>
                    <div class="text-slate-600">this period</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tariff Breakdown -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="card rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-6">Tariff Usage Breakdown</h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="flex items-center gap-4">
                        <div class="w-24 h-24">
                            <canvas id="tariffPie"></canvas>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-slate-800">27.7%</div>
                            <div class="text-slate-500">Cheap rate usage</div>
                        </div>
                    </div>
                    <div class="cheap-gradient rounded-xl p-5 text-white">
                        <div class="text-emerald-100 text-sm font-medium">Cheap Rate (00:00â€“07:00)</div>
                        <div class="text-3xl font-bold mt-1">797 kWh</div>
                        <div class="text-emerald-100 mt-1">@ 10.5p/kWh = Â£83.64</div>
                    </div>
                    <div class="peak-gradient rounded-xl p-5 text-white">
                        <div class="text-amber-100 text-sm font-medium">Peak Rate (07:00â€“00:00)</div>
                        <div class="text-3xl font-bold mt-1">2,074 kWh</div>
                        <div class="text-amber-100 mt-1">@ 24.5p/kWh = Â£508.13</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Charts Row -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Hourly Pattern -->
                <div class="card rounded-2xl shadow-xl p-6">
                    <h2 class="text-xl font-semibold text-slate-800 mb-2">Hourly Usage Pattern</h2>
                    <p class="text-slate-500 text-sm mb-4">Average consumption by hour of day</p>
                    <div class="h-64">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>

                <!-- Daily Usage -->
                <div class="card rounded-2xl shadow-xl p-6">
                    <h2 class="text-xl font-semibold text-slate-800 mb-2">Daily Consumption</h2>
                    <p class="text-slate-500 text-sm mb-4">Cheap vs peak rate breakdown</p>
                    <div class="h-64">
                        <canvas id="dailyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Day of Week + Sauna -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Day of Week -->
                <div class="card rounded-2xl shadow-xl p-6">
                    <h2 class="text-xl font-semibold text-slate-800 mb-2">Day of Week Pattern</h2>
                    <p class="text-slate-500 text-sm mb-4">Average daily consumption by weekday</p>
                    <div class="h-64">
                        <canvas id="weekdayChart"></canvas>
                    </div>
                </div>

                <!-- Sauna Impact -->
                <div class="card rounded-2xl shadow-xl p-6">
                    <h2 class="text-xl font-semibold text-slate-800 mb-2">Sauna Impact</h2>
                    <p class="text-slate-500 text-sm mb-4">Daily consumption comparison</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-slate-100 rounded-xl p-4 text-center">
                            <div class="text-3xl font-bold text-slate-800">88</div>
                            <div class="text-slate-500 text-sm">kWh avg (no sauna)</div>
                            <div class="text-slate-400 text-xs mt-1">21 days</div>
                        </div>
                        <div class="sauna-gradient rounded-xl p-4 text-center text-white">
                            <div class="text-3xl font-bold">127</div>
                            <div class="text-red-100 text-sm">kWh avg (sauna)</div>
                            <div class="text-red-200 text-xs mt-1">8 days</div>
                        </div>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                        <div class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            <span class="text-red-700 font-medium">+39 kWh per sauna day</span>
                        </div>
                        <div class="text-red-600 text-sm mt-1">Average additional cost: ~Â£9.50</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sauna Sessions Table -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="card rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-2">Sauna Sessions</h2>
                <p class="text-slate-500 text-sm mb-4">All recorded sessions with electricity correlation</p>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-slate-200">
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Date</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Start Time</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Duration</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Peak Temp</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Energy</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Tariff</th>
                            </tr>
                        </thead>
                        <tbody id="saunaTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Insights -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-6">Key Insights</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="card rounded-xl p-5 insight-card border-emerald-500">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800">Smart Sauna Scheduling</h3>
                            <p class="text-slate-600 text-sm mt-1">60% of sauna sessions start during cheap rate hours. Early morning sessions (before 7am) save approximately Â£3-4 per session compared to afternoon use.</p>
                        </div>
                    </div>
                </div>

                <div class="card rounded-xl p-5 insight-card border-amber-500">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800">Evening Peak Alert</h3>
                            <p class="text-slate-600 text-sm mt-1">5-8pm sees 4x the consumption of midday hours. This is your most expensive window at 24.5p/kWh. Consider shifting discretionary loads to after midnight.</p>
                        </div>
                    </div>
                </div>

                <div class="card rounded-xl p-5 insight-card border-blue-500">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800">Baseload Analysis</h3>
                            <p class="text-slate-600 text-sm mt-1">Your always-on baseload is ~0.37 kWh per half-hour (18 kWh/day, ~Â£4.40/day). This is typical for a three-phase house but worth auditing for phantom loads.</p>
                        </div>
                    </div>
                </div>

                <div class="card rounded-xl p-5 insight-card border-purple-500">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800">Weekly Pattern</h3>
                            <p class="text-slate-600 text-sm mt-1">Tuesdays are your lowest usage day (80 kWh avg), while Wed-Sat cluster around 110 kWh. Consider scheduling high-energy tasks for Tuesdays if possible.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Potential Savings -->
    <section class="px-4 pb-8">
        <div class="max-w-7xl mx-auto">
            <div class="card rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-6">Cost Optimization Potential</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <div class="text-slate-600 mb-4">If all peak usage could be shifted to cheap rate:</div>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center py-2 border-b border-slate-100">
                                <span class="text-slate-600">Current peak cost</span>
                                <span class="font-semibold text-slate-800">Â£508.13</span>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-slate-100">
                                <span class="text-slate-600">If at cheap rate</span>
                                <span class="font-semibold text-emerald-600">Â£217.77</span>
                            </div>
                            <div class="flex justify-between items-center py-2 bg-emerald-50 rounded-lg px-3">
                                <span class="text-emerald-700 font-medium">Maximum potential savings</span>
                                <span class="font-bold text-emerald-600 text-xl">Â£290.36</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="text-slate-600 mb-4">Realistic opportunities:</div>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600">ðŸ§º</span>
                                    </div>
                                    <span class="text-slate-700">Dishwasher/washing overnight</span>
                                </div>
                                <span class="text-emerald-600 font-medium">Â£5-10/mo</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600">ðŸ”Œ</span>
                                    </div>
                                    <span class="text-slate-700">EV charging (if applicable)</span>
                                </div>
                                <span class="text-emerald-600 font-medium">Â£20-50/mo</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600">ðŸ§–</span>
                                    </div>
                                    <span class="text-slate-700">All sauna before 7am</span>
                                </div>
                                <span class="text-emerald-600 font-medium">Â£10-15/mo</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Anomalies -->
    <section class="px-4 pb-12">
        <div class="max-w-7xl mx-auto">
            <div class="card rounded-2xl shadow-xl p-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-2">Anomalies to Investigate</h2>
                <p class="text-slate-500 text-sm mb-4">Unusually high consumption periods not explained by sauna usage</p>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-slate-200">
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Timestamp</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Consumption</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Context</th>
                                <th class="text-left py-3 px-4 text-slate-600 font-medium">Possible Cause</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-4 text-slate-800">1 Jan 2026, 17:00</td>
                                <td class="py-3 px-4"><span class="bg-red-100 text-red-700 px-2 py-1 rounded font-medium">11.36 kWh</span></td>
                                <td class="py-3 px-4 text-slate-600">Not during sauna</td>
                                <td class="py-3 px-4 text-slate-500">New Year's Day cooking/heating?</td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-4 text-slate-800">31 Dec 2025, 19:30</td>
                                <td class="py-3 px-4"><span class="bg-amber-100 text-amber-700 px-2 py-1 rounded font-medium">8.96 kWh</span></td>
                                <td class="py-3 px-4 text-slate-600">Not during sauna</td>
                                <td class="py-3 px-4 text-slate-500">New Year's Eve party prep?</td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-4 text-slate-800">6 Jan 2026, 16:30</td>
                                <td class="py-3 px-4"><span class="bg-amber-100 text-amber-700 px-2 py-1 rounded font-medium">7.95 kWh</span></td>
                                <td class="py-3 px-4 text-slate-600">Not during sauna</td>
                                <td class="py-3 px-4 text-slate-500">Multiple high-draw appliances</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-8 px-4 border-t border-slate-700">
        <div class="max-w-7xl mx-auto text-center">
            <p class="text-slate-400 text-sm">Home Energy Analysis Report â€¢ Data from EON Smart Meter</p>
            <p class="text-slate-500 text-xs mt-2">Generated automatically from energy-analysis.db</p>
        </div>
    </footer>

    <script>
        // Data
        const hourlyData = [{"hour":0,"avg_kwh":2.371},{"hour":1,"avg_kwh":2.478},{"hour":2,"avg_kwh":1.78},{"hour":3,"avg_kwh":1.521},{"hour":4,"avg_kwh":1.425},{"hour":5,"avg_kwh":2.023},{"hour":6,"avg_kwh":2.585},{"hour":7,"avg_kwh":3.508},{"hour":8,"avg_kwh":2.687},{"hour":9,"avg_kwh":1.67},{"hour":10,"avg_kwh":0.858},{"hour":11,"avg_kwh":1.082},{"hour":12,"avg_kwh":1.034},{"hour":13,"avg_kwh":1.064},{"hour":14,"avg_kwh":1.042},{"hour":15,"avg_kwh":1.277},{"hour":16,"avg_kwh":2.298},{"hour":17,"avg_kwh":4.273},{"hour":18,"avg_kwh":3.223},{"hour":19,"avg_kwh":3.242},{"hour":20,"avg_kwh":3.142},{"hour":21,"avg_kwh":2.833},{"hour":22,"avg_kwh":2.065},{"hour":23,"avg_kwh":0.782}];

        const dailyData = [{"day":"2025-12-31","kwh":121.62,"cheap_kwh":0,"peak_kwh":121.62},{"day":"2026-01-01","kwh":164.74,"cheap_kwh":36.04,"peak_kwh":128.7},{"day":"2026-01-02","kwh":108.55,"cheap_kwh":23.51,"peak_kwh":85.04},{"day":"2026-01-03","kwh":149.5,"cheap_kwh":15.06,"peak_kwh":134.45},{"day":"2026-01-04","kwh":142.15,"cheap_kwh":16.61,"peak_kwh":125.54},{"day":"2026-01-05","kwh":116.73,"cheap_kwh":19.91,"peak_kwh":96.82},{"day":"2026-01-06","kwh":106.29,"cheap_kwh":29.47,"peak_kwh":76.82},{"day":"2026-01-07","kwh":120.35,"cheap_kwh":53.34,"peak_kwh":67.01},{"day":"2026-01-08","kwh":90.75,"cheap_kwh":27.15,"peak_kwh":63.59},{"day":"2026-01-09","kwh":134.12,"cheap_kwh":33.12,"peak_kwh":101},{"day":"2026-01-10","kwh":125.56,"cheap_kwh":29.8,"peak_kwh":95.76},{"day":"2026-01-11","kwh":96.62,"cheap_kwh":24.7,"peak_kwh":71.92},{"day":"2026-01-12","kwh":75.3,"cheap_kwh":26.46,"peak_kwh":48.84},{"day":"2026-01-13","kwh":67.5,"cheap_kwh":15.43,"peak_kwh":52.07},{"day":"2026-01-14","kwh":91.99,"cheap_kwh":28.44,"peak_kwh":63.55},{"day":"2026-01-15","kwh":76.3,"cheap_kwh":26.8,"peak_kwh":49.5},{"day":"2026-01-16","kwh":108.18,"cheap_kwh":53.94,"peak_kwh":54.25},{"day":"2026-01-17","kwh":105.58,"cheap_kwh":36.38,"peak_kwh":69.2},{"day":"2026-01-18","kwh":91.72,"cheap_kwh":32.88,"peak_kwh":58.84},{"day":"2026-01-19","kwh":96.67,"cheap_kwh":30.62,"peak_kwh":66.05},{"day":"2026-01-20","kwh":76.83,"cheap_kwh":29.83,"peak_kwh":46.99},{"day":"2026-01-21","kwh":65.59,"cheap_kwh":17.38,"peak_kwh":48.21},{"day":"2026-01-22","kwh":112.73,"cheap_kwh":65.09,"peak_kwh":47.64},{"day":"2026-01-23","kwh":71.2,"cheap_kwh":28.63,"peak_kwh":42.57},{"day":"2026-01-24","kwh":59.99,"cheap_kwh":12.53,"peak_kwh":47.46},{"day":"2026-01-25","kwh":61.03,"cheap_kwh":12.8,"peak_kwh":48.23},{"day":"2026-01-26","kwh":65.68,"cheap_kwh":17.18,"peak_kwh":48.5},{"day":"2026-01-27","kwh":67.88,"cheap_kwh":15.21,"peak_kwh":52.66},{"day":"2026-01-28","kwh":98.96,"cheap_kwh":37.78,"peak_kwh":61.18}];

        const weekdayData = [{"day_name":"Sun","avg_daily_kwh":97.88},{"day_name":"Mon","avg_daily_kwh":88.59},{"day_name":"Tue","avg_daily_kwh":79.62},{"day_name":"Wed","avg_daily_kwh":110.27},{"day_name":"Thu","avg_daily_kwh":110.67},{"day_name":"Fri","avg_daily_kwh":105.51},{"day_name":"Sat","avg_daily_kwh":110.16}];

        const saunaData = [{"start_time":"2026-01-01T06:26:50","duration_minutes":375,"peak_temperature_c":66,"session_kwh":48.21,"tariff":"cheap"},{"start_time":"2026-01-01T17:06:27","duration_minutes":307,"peak_temperature_c":66,"session_kwh":60.22,"tariff":"peak"},{"start_time":"2026-01-03T11:57:15","duration_minutes":439,"peak_temperature_c":68,"session_kwh":64.74,"tariff":"peak"},{"start_time":"2026-01-04T15:39:52","duration_minutes":322,"peak_temperature_c":68,"session_kwh":54.67,"tariff":"peak"},{"start_time":"2026-01-09T05:58:55","duration_minutes":356,"peak_temperature_c":68,"session_kwh":42.96,"tariff":"cheap"},{"start_time":"2026-01-10T05:25:28","duration_minutes":434,"peak_temperature_c":67,"session_kwh":51.8,"tariff":"cheap"},{"start_time":"2026-01-17T05:52:15","duration_minutes":412,"peak_temperature_c":68,"session_kwh":35.72,"tariff":"cheap"},{"start_time":"2026-01-19T05:50:02","duration_minutes":422,"peak_temperature_c":68,"session_kwh":30.23,"tariff":"cheap"},{"start_time":"2026-01-28T05:56:24","duration_minutes":406,"peak_temperature_c":69,"session_kwh":33.06,"tariff":"cheap"},{"start_time":"2026-01-29T16:33:12","duration_minutes":372,"peak_temperature_c":68,"session_kwh":null,"tariff":"peak"}];

        // Tariff Pie Chart
        new Chart(document.getElementById('tariffPie'), {
            type: 'doughnut',
            data: {
                labels: ['Cheap', 'Peak'],
                datasets: [{
                    data: [27.7, 72.3],
                    backgroundColor: ['#10b981', '#f59e0b'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: false } },
                cutout: '70%'
            }
        });

        // Hourly Chart
        new Chart(document.getElementById('hourlyChart'), {
            type: 'bar',
            data: {
                labels: hourlyData.map(d => d.hour + ':00'),
                datasets: [{
                    label: 'Avg kWh',
                    data: hourlyData.map(d => d.avg_kwh),
                    backgroundColor: hourlyData.map(d => d.hour < 7 ? '#10b981' : '#f59e0b'),
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'kWh' } },
                    x: { ticks: { maxRotation: 45 } }
                }
            }
        });

        // Daily Chart
        new Chart(document.getElementById('dailyChart'), {
            type: 'bar',
            data: {
                labels: dailyData.map(d => d.day.slice(5)),
                datasets: [
                    {
                        label: 'Cheap Rate',
                        data: dailyData.map(d => d.cheap_kwh),
                        backgroundColor: '#10b981',
                        borderRadius: 4
                    },
                    {
                        label: 'Peak Rate',
                        data: dailyData.map(d => d.peak_kwh),
                        backgroundColor: '#f59e0b',
                        borderRadius: 4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { position: 'top' } },
                scales: {
                    x: { stacked: true, ticks: { maxRotation: 45 } },
                    y: { stacked: true, title: { display: true, text: 'kWh' } }
                }
            }
        });

        // Weekday Chart
        new Chart(document.getElementById('weekdayChart'), {
            type: 'bar',
            data: {
                labels: weekdayData.map(d => d.day_name),
                datasets: [{
                    label: 'Avg Daily kWh',
                    data: weekdayData.map(d => d.avg_daily_kwh),
                    backgroundColor: ['#8b5cf6', '#6366f1', '#3b82f6', '#0ea5e9', '#14b8a6', '#22c55e', '#84cc16'],
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, max: 130, title: { display: true, text: 'kWh' } }
                }
            }
        });

        // Populate Sauna Table
        const saunaTable = document.getElementById('saunaTable');
        saunaData.forEach(session => {
            const date = new Date(session.start_time);
            const dateStr = date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });
            const timeStr = date.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
            const hours = Math.floor(session.duration_minutes / 60);
            const mins = session.duration_minutes % 60;
            const durationStr = `${hours}h ${mins}m`;
            const kwhStr = session.session_kwh ? `${session.session_kwh} kWh` : 'â€”';
            const tariffClass = session.tariff === 'cheap' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700';
            const tariffLabel = session.tariff === 'cheap' ? 'Cheap' : 'Peak';

            saunaTable.innerHTML += `
                <tr class="border-b border-slate-100 hover:bg-slate-50">
                    <td class="py-3 px-4 text-slate-800">${dateStr}</td>
                    <td class="py-3 px-4 text-slate-600">${timeStr}</td>
                    <td class="py-3 px-4 text-slate-600">${durationStr}</td>
                    <td class="py-3 px-4 text-slate-600">${session.peak_temperature_c}Â°C</td>
                    <td class="py-3 px-4 text-slate-800 font-medium">${kwhStr}</td>
                    <td class="py-3 px-4"><span class="px-2 py-1 rounded text-sm font-medium ${tariffClass}">${tariffLabel}</span></td>
                </tr>
            `;
        });
    </script>
</body>
</html>
